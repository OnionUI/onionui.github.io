<!doctype html>
<html>
<head>
<title>Dots-draw</title>
<meta name="theme-color" media="(prefers-color-scheme: dark)"  content="#383845">
<link rel="manifest" href="/dots-draw.webmanifest">
<link rel="stylesheet" href="style.css">
<link rel="icon" type="image/png" href="res/dots-draw-icon-32.png" />
</head>
<body>
<script src="app.js"></script>
<div class="menu-bar">
    <div class="left-side">
        <button class="icon" title="New file" onclick="newFile()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <path d="M4 22h14a2 2 0 002-2V7.5L14.5 2H6a2 2 0 00-2 2v4" />
            <path d="M14 2v6h6" />
            <path d="M3 15h6" />
            <path d="M6 12v6" />
        </svg></button>
        <button class="icon" title="Open (Ctrl+O)" onclick="openFile()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <path d="M6 17l2-5h14l-3 8a2 2 0 01-2 1H4a2 2 0 01-2-2V5a2 2 0 012-2h5l2 3h7a2 2 0 012 2v4" />
        </svg></button>
        <div class="separator"></div>
        <button disabled class="icon" title="Save (Ctrl+S)" id="save_button" onclick="saveFile()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" />
            <polyline points="17 21 17 13 7 13 7 21" />
            <polyline points="7 3 7 8 15 8" />
        </svg></button>
        <button class="icon" title="Save as... (Ctrl+S)" onclick="saveAs()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path transform="translate(-2,1)"  d="M3 7.6v12.8c0 .4.2.8.5 1.1.3.3.7.5 1.1.5h9.8" />
            <g transform="translate(1,-1)">
                <path d="M19 21H5a2 2 0 01-2-2V5a2 2 0 012-2h11l5 5v11a2 2 0 01-2 2z" />
                <polyline points="17 21 17 13 7 13 7 21" />
                <polyline points="7 3 7 8 15 8" />
            </g>
        </svg></button>
        <div class="separator"></div>
        <button class="icon" title="Undo (Ctrl+Z)" disabled id="button_undo" onclick="history_undo()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <path d="M3 7v6h6" />
            <path d="M21 17a9 9 0 00-9-9 9 9 0 00-6 2.3L3 13" />
        </svg></button>
        <button class="icon" title="Redo (Ctrl+Y)" disabled id="button_redo" onclick="history_redo()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <path d="M21 7v6h-6" />
            <path d="M3 17a9 9 0 019-9 9 9 0 016 2.3l3 2.7" />
        </svg></button>
        <div class="separator"></div>
        <button class="icon" title="Import image... (Ctrl+I)" onclick="importImage()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <rect x="3" y="3" width="18" height="18" rx="2" ry="2" />
            <circle cx="8.5" cy="8.5" r="1.5" />
            <polyline points="21 15 16 10 5 21" />
        </svg></button>
    </div>
    <div class="middle-part">
        <button class="icon active" title="Pen Tool" id="tool_0" onclick="switchTool(PEN_TOOL)"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M12 19l7-7 3 3-7 7-3-3z" />
            <path d="M18 13l-1.5-7.5L2 2l3.5 14.5L13 18l5-5z" />
            <path d="M2 2l7.586 7.586" />
            <circle cx="11" cy="11" r="2" />
        </svg></button>
        <button class="icon" title="Select Tool" id="tool_1" onclick="switchTool(SELECT_TOOL)"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M4 2a2 2 0 00-2 2" />
            <line x1="8" y1="2" x2="10" y2="2" />
            <line x1="14" y1="2" x2="16" y2="2" />
            <path d="M4 22a2 2 0 01-2-2" />
            <line x1="22" y1="8" x2="22" y2="10" />
            <line x1="22" y1="14" x2="22" y2="16" />
            <path d="M22 20a2 2 0 01-2 2" />
            <line x1="14" y1="22" x2="16" y2="22" />
            <line x1="8" y1="22" x2="10" y2="22" />
            <path d="M20 2a2 2 0 012 2" />
            <line x1="2" y1="14" x2="2" y2="16" />
            <line x1="2" y1="8" x2="2" y2="10" />
        </svg></button>
    </div>
    <div class="right-side">
        <button class="icon export-settings-toggle" title="Toggle export options" onclick="document.body.classList.toggle('show-export-settings')"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M20 7h-9" />
            <path d="M14 17H5" />
            <circle cx="17" cy="17" r="3" />
            <circle cx="7" cy="7" r="3" />
        </svg></button>
        <div class="separator"></div>
        <button class="icon" title="Export image... (Ctrl+E)" onclick="exportImage()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M4 12v8a2 2 0 002 2h12a2 2 0 002-2v-8" />
            <polyline points="16 6 12 2 8 6" />
            <line x1="12" y1="2" x2="12" y2="15" />
        </svg></button>
    </div>
</div>
<div class="extra-controls bg-image-controls">
    <button class="icon" title="Clear background" onclick="clearBackground()"><svg 
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="#000000"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M21 11v8a2 2 0 01-2 2H5a2 2 0 01-2-2V5a2 2 0 012-2h8" />
        <path d="M8.5 10a1.5 1.5 0 100-3 1.5 1.5 0 000 3z" />
        <path d="M21 15l-5-5L5 21" />
        <path d="M22 5h-6" />
    </svg></button>
    <div class="separator"></div>
    <div class="input-slider">
        <label for="bg_opacity">Opacity</label>
        <div class="input-wrapper" data-units="%" data-value="20" style="--data-value: 20;"><input type="range" id="bg_opacity" step="1" value="20" min="0" max="100" oninput="this.parentNode.dataset.value = this.value; this.parentNode.style.setProperty('--data-value', this.value); updateBackgroundImage()"></div>
    </div>
    <button class="icon icon-eye-off" title="Show background" onclick="document.body.classList.toggle('hide-bg-image')"><svg 
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="#000000"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M17.94 17.94A10.07 10.07 0 0112 20c-7 0-11-8-11-8a18.45 18.45 0 015.06-5.94M9.9 4.24A9.12 9.12 0 0112 4c7 0 11 8 11 8a18.5 18.5 0 01-2.16 3.19m-6.72-1.07a3 3 0 11-4.24-4.24" />
        <line x1="1" y1="1" x2="23" y2="23" />
    </svg></button>
    <button class="icon icon-eye" title="Hide background" onclick="document.body.classList.toggle('hide-bg-image')"><svg 
        xmlns="http://www.w3.org/2000/svg"
        width="24"
        height="24"
        viewBox="0 0 24 24"
        fill="none"
        stroke="#000000"
        stroke-width="2"
        stroke-linecap="round"
        stroke-linejoin="round"
      >
        <path d="M1 12s4-8 11-8 11 8 11 8-4 8-11 8-11-8-11-8z" />
        <circle cx="12" cy="12" r="3" />
    </svg></button>
    <div class="separator"></div>
    <div class="number-picker">
        <label for="int_scalar">Scale</label>
        <div class="input-wrapper" data-units="1:"><input type="number" id="int_scalar" min="1" step="1" value="3" onchange="updateIntScalar(this.value)"></div>
    </div>
    <div class="number-picker">
        <label for="bg_offset_x">X</label>
        <div class="input-wrapper" data-units="px"><input type="number" id="bg_offset_x" step="1" value="0" onchange="updateBackgroundImage()"></div>
    </div>
    <div class="number-picker">
        <label for="bg_offset_y">Y</label>
        <div class="input-wrapper" data-units="px"><input type="number" id="bg_offset_y" step="1" value="0" onchange="updateBackgroundImage()"></div>
    </div>
    <div class="separator"></div>
    <div id="autofill_submenu" class="autofill-submenu" onmouseenter="this.classList.add('autofill-preview-active'); autoFill_showPreview()" onmouseleave="autoFill_hidePreview(); this.classList.remove('autofill-preview-active')" onfocusin="autoFill_showPreview()" onfocusout="if (!this.classList.contains('autofill-preview-active')) autoFill_hidePreview();">
        <button class="icon icon-sun" title="Autofill mode: Light" onclick="document.body.classList.toggle('autofill-mode-light'); autoFill_showPreview()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <circle cx="12" cy="12" r="4" />
            <path d="M12 2v2" />
            <path d="M12 20v2" />
            <path d="M5 5l1.5 1.5" />
            <path d="M17.5 17.5L19 19" />
            <path d="M2 12h2" />
            <path d="M20 12h2" />
            <path d="M5 19l1.5-1.5" />
            <path d="M17.5 6.5L19 5" />
        </svg></button>
        <button class="icon icon-moon" title="Autofill mode: Dark" onclick="document.body.classList.toggle('autofill-mode-light'); autoFill_showPreview()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M21 12.79A9 9 0 1111.21 3 7 7 0 0021 12.79z" />
        </svg></button>
        <div class="input-slider">
            <label for="autofill_cutoff">Cutoff</label>
            <div class="input-wrapper" data-units="%" data-value="5" style="--data-value: 5;"><input type="range" id="autofill_cutoff" step="1" value="5" min="0" max="100" oninput="this.parentNode.dataset.value = this.value; this.parentNode.style.setProperty('--data-value', this.value); autoFill_showPreview()"></div>
        </div>
        <button class="icon" title="Auto fill" onclick="autoFill_apply()"><svg 
            xmlns="http://www.w3.org/2000/svg"
            width="24"
            height="24"
            viewBox="0 0 24 24"
            fill="none"
            stroke="#000000"
            stroke-width="2"
            stroke-linecap="round"
            stroke-linejoin="round"
        >
            <path d="M15 4V2" />
            <path d="M15 16v-2" />
            <path d="M8 9h2" />
            <path d="M20 9h2" />
            <path d="M17.8 11.8L19 13" />
            <path d="M15 9h0" />
            <path d="M17.8 6.2L19 5" />
            <path d="M3 21l9-9" />
            <path d="M12.2 6.2L11 5" />
        </svg></button>
    </div>
</div>
<div class="extra-controls preview-settings">
    <div class="number-picker">
        <label for="preview_offset_x">X</label>
        <div class="input-wrapper" data-units="px"><input type="number" id="preview_offset_x" step="1" value="0" onchange="updatePreview()"></div>
    </div>
    <div class="number-picker">
        <label for="preview_offset_y">Y</label>
        <div class="input-wrapper" data-units="px"><input type="number" id="preview_offset_y" step="1" value="0" onchange="updatePreview()"></div>
    </div>
    <div class="number-picker">
        <label for="dot_size">Dot Size</label>
        <div class="input-wrapper" data-units="px"><input type="number" id="dot_size" min="1" max="256" step="1" value="3" onchange="updatePreview()"></div>
    </div>
    <div class="number-picker">
        <label for="dot_gap">Dot Gap</label>
        <div class="input-wrapper" data-units="px"><input type="number" id="dot_gap" min="0" max="256" step="1" value="0" onchange="updatePreview()"></div>
    </div>
    <div class="color-picker">
        <label for="export_color">Color<input type="color" id="export_color" value="#ffffff" onchange="updatePreview()"></label>
    </div>
</div>
<div class="canvas-container">
    <div>
        <div class="bg-image"><canvas id="bg_image" width="0" height="0"></canvas></div>
        <div class="canvas" id="app_canvas"></div>
    </div>
</div>
<div class="preview-container">
    <div class="preview-canvas">
        <canvas id="preview" width="0" height="0"></canvas>
    </div>
    <div class="status" id="preview_status"></div>
</div>
<div class="status-bar">
    <div id="status"></div>
</div>
<div class="drop-area" id="drop_area"></div>
<!-- Icons from: https://www.svgrepo.com/collection/lucide-line-icons -->
</body>
</html>